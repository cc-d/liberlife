[Unit]
Description=LiberLife Service
After=network.target

[Service]
Type=simple
User=cary
WorkingDirectory=/home/cary/liberlife
Environment="LIBLIFE_ENV=prod"
Environment="VIRTUAL_ENV=/home/cary/liberlife/venv"
Environment="PATH=$VIRTUAL_ENV/bin:$PATH"

ExecStart=/bin/sh -c ". /home/cary/liberlife/.envs/prod.env && \
    echo "$LIBLIFE_ENV" && \
    cd /home/cary/liberlife && \
    . /home/cary/liberlife/venv/bin/activate && \
    uvicorn api.app.main:app --port $API_PORT --host $API_HOST --reload"

Restart=never

[Install]
WantedBy=multi-user.target
